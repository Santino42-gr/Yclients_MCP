# üîå –ù–∞—Å—Ç—Ä–æ–π–∫–∞ n8n MCP Client —Å YClients —Å–µ—Ä–≤–µ—Ä–æ–º

## ‚ö° –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (5 –º–∏–Ω—É—Ç)

### 1. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Railway**

–í–∞—à MCP —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
```
https://your-project-name.up.railway.app
```

**–í–∞–∂–Ω—ã–µ endpoints:**
- üè• Health check: `/health`
- üì° **SSE –¥–ª—è n8n**: `/sse` ‚Üê **—ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π endpoint!**
- üìÑ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: `/`

### 2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ MCP Client –≤ n8n**

–í –≤–∞—à–µ–º n8n workflow:

1. **–î–æ–±–∞–≤—å—Ç–µ —É–∑–µ–ª "MCP Client"**
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

```
üîó SSE Endpoint: https://your-project-name.up.railway.app/sse
üîê Authentication: None
üõ†Ô∏è Tools to Include: All
```

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MCP Client –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å **‚úÖ Connected**

–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: `curl https://your-url/health`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URL –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `/sse`
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ Railway dashboard

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ê—Ä–≥—É–º–µ–Ω—Ç—ã |
|------------|------------|-----------|
| `book_appointment` | –ó–∞–ø–∏—Å—å –∫–ª–∏–µ–Ω—Ç–∞ | `client_phone`, `client_name`, `service_name`, `preferred_date`, `preferred_time` |
| `find_available_time` | –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ | `service_name`, `date`, `duration_minutes` |
| `get_services_list` | –°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ —Å–∞–ª–æ–Ω–∞ | –Ω–µ—Ç |
| `get_staff_list` | –°–ø–∏—Å–æ–∫ –º–∞—Å—Ç–µ—Ä–æ–≤ | –Ω–µ—Ç |
| `find_client` | –ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞ | `phone` –∏–ª–∏ `name` |
| `get_client_bookings` | –ó–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞ | `client_phone` |
| `cancel_booking` | –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏ | `booking_id` |

### –ü—Ä–∏–º–µ—Ä workflow –¥–ª—è Telegram –±–æ—Ç–∞:

```
1. [Webhook] ‚Üê –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Telegram
     ‚Üì
2. [Switch] ‚Üê –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã (/–∑–∞–ø–∏—Å—å, /–æ—Ç–º–µ–Ω–∞ –∏ —Ç.–¥.)
     ‚Üì
3. [MCP Client] ‚Üê –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ YClients —Å–µ—Ä–≤–µ—Ä—É
     ‚Üì
4. [Call Tool: book_appointment] ‚Üê –∑–∞–ø–∏—Å—å –∫–ª–∏–µ–Ω—Ç–∞
     ‚Üì
5. [HTTP Request] ‚Üê –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –≤ Telegram
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∑–∞–ø–∏—Å–∏:

**Tool**: `book_appointment`

**Arguments**:
```json
{
  "client_phone": "{{ $json.body.message.from.phone_number || '+79123456789' }}",
  "client_name": "{{ $json.body.message.from.first_name }} {{ $json.body.message.from.last_name }}",
  "service_name": "{{ $json.parsed_message.service }}",
  "preferred_date": "{{ $json.parsed_message.date }}",
  "preferred_time": "{{ $json.parsed_message.time }}"
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```json
{
  "content": [
    {
      "type": "text", 
      "text": "‚úÖ –ö–ª–∏–µ–Ω—Ç –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞ –∑–∞–ø–∏—Å–∞–Ω –Ω–∞ —Å—Ç—Ä–∏–∂–∫—É 25.12.2024 –≤ 15:00"
    }
  ]
}
```

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `{{ $json.content[0].text }}` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –æ—Ç–≤–µ—Ç–∞.

## üîÑ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### 1. **–£–º–Ω–∞—è –∑–∞–ø–∏—Å—å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤—Ä–µ–º–µ–Ω–∏**

```
[MCP: find_available_time] ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
     ‚Üì (–µ—Å–ª–∏ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–æ)
[MCP: find_available_time] ‚Üí –ø–æ–∏—Å–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤
     ‚Üì (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ)
[MCP: book_appointment] ‚Üí –∑–∞–ø–∏—Å—å –Ω–∞ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è
```

### 2. **–ü–æ–∏—Å–∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞**

```
[MCP: find_client] ‚Üí –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
     ‚Üì (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω)
[MCP: get_client_bookings] ‚Üí –ø–æ–∫–∞–∑ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø–∏—Å–µ–π
     ‚Üì
[MCP: book_appointment] ‚Üí –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å (–∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
```

### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–º–µ–Ω—ã**

```
[MCP: find_client] ‚Üí –ø–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞
     ‚Üì
[MCP: get_client_bookings] ‚Üí —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
     ‚Üì (–≤—ã–±–æ—Ä –∑–∞–ø–∏—Å–∏)
[MCP: cancel_booking] ‚Üí –æ—Ç–º–µ–Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### Health check:
```bash
curl https://your-project.up.railway.app/health
# –û—Ç–≤–µ—Ç: {"status":"ok","service":"yclients-mcp-server","endpoint":"/sse"}
```

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
curl https://your-project.up.railway.app/
# –ü–æ–∫–∞–∂–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ endpoints –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
```

### –õ–æ–≥–∏ Railway:
1. Railway Dashboard ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç
2. **Deployments** ‚Üí **View Logs**
3. –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   - `üì° –ù–æ–≤–æ–µ SSE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ` ‚Üê n8n –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è
   - `üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —Å–µ—Å—Å–∏–∏` ‚Üê –≤—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
   - `‚ùå –û—à–∏–±–∫–∞` ‚Üê –ø—Ä–æ–±–ª–µ–º—ã

## üö® Troubleshooting

**n8n –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL: –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `/sse`
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (health check)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Railway

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ YClients —Ç–æ–∫–µ–Ω –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Company ID –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- ‚úÖ –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ Railway –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–æ–∫

**–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ rate limits YClients API
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ —É—Å–ª—É–≥/–º–∞—Å—Ç–µ—Ä–æ–≤
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ workflow –¥–ª—è –º–∏–Ω–∏–º—É–º–∞ –≤—ã–∑–æ–≤–æ–≤ API

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º YClients API! üéâ 